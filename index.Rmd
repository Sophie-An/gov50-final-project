---
title: "Gov 50 Final Project"
author: "Sophie-An Kingsbury Lee"
description: "Final project!"
output:
self_contained: false
    
---



## Project thoughts

I'd love to use data about the effects of environmental policy on behavior by comparing some metric before and after a change in policy. There isn't a specific policy I'm thinking about yet. I also may use EPA data. Alternatively, I'd like to compare the effects of different incentives (immediate cash, future benefit, laws/mandates) in the environmental realm.

I've changed what I'm doing from using NAEP score reports to looking at the question: "How does being affected by severe weather affect views of government and personal behaviors?"


```{r}
library(tidyverse)
library(infer)
```


```{r}
library(haven)
load_savfile <- read_spss("data/ATPW55.sav")
saveascsv <- write.csv(load_savfile, file = "data/atp.csv", row.names = FALSE)
atp <- read_csv("data/atp.csv")
```

```{r}
## People who think human activity affects climate change "Not too much"
not_human_activity <- atp |>
  filter(ENVIR8_a_W55 == 3) |>
  mutate(less_meat = if_else(EN6F1_a_W55 == 1, 1, 0),
         carpool = if_else(EN6F1_b_W55 == 1, 1, 0))

## Carpool and meat consumption rates
not_human_activity |>
  summarize(less_meat_prop = mean(less_meat, na.rm = TRUE) ,
            carpool_prop = mean(carpool, na.rm = TRUE))

## People who think human activity affects climate change a lot
human_activity <- atp |>
  filter(ENVIR8_a_W55 < 3) |>
  mutate(less_meat = if_else(EN6F1_a_W55 == 1, 1, 0),
         carpool = if_else(EN6F1_b_W55 == 1, 1, 0))

# Carpool and meat consumption rates
human_activity |>
  summarize(less_meat_prop = mean(less_meat, na.rm = TRUE) ,
            carpool_prop = mean(carpool, na.rm = TRUE))


```
Of the people who think human activity contributes to climate change "Not too much" or "Not at all," one quarter eat less meat and 40% carpool to help protect the environment. Of the people who think human activity contributes to climate change "A great deal" or "Some", half eat less meat and carpool to help protect the environment.


how are the weather changes/disasters impacting a person correlated with support of government response to environmental issues and personal choices? (show how people affected by natural disaster more supportive of gov't)

```{r}
atp <- atp |>
  mutate(behavior_freq = case_when(
    ENV17_W55 == 1 ~ "All the time",
    ENV17_W55 == 2 ~ "Some of the time",
    ENV17_W55 == 3 ~ "Not often",
    ENV17_W55 == 4 ~ "Not at all"))

# people who think climate change is affecting their local community "A great deal" or "Some"
affected <- atp |>
  filter(CLIM9F1_a_W55 < 3 | (CLIM9F1_b_W55 < 3))

# people who think climate change is affecting their local community "Not much" or "Not at all"
unaffected <- atp |>
  filter(CLIM9F1_a_W55 > 2 | (CLIM9F1_b_W55 > 2))

affected
unaffected
```


```{r}
drought <- affected |>
  count(CLIM10_a_W55) |>
  pull(n)

prop_drought_aff <- drought[1]/(drought[1] + drought[2])

heat <- affected |>
  count(CLIM10_b_W55) |>
  pull(n)

prop_heat_aff <- heat[1]/(heat[1] + heat[2])

sweather <- affected |>
  count(CLIM10_c_W55) |>
  pull(n)

prop_sweather_aff <- sweather[1]/(sweather[1] + sweather[2])

sea <- affected |>
  count(CLIM10_d_W55) |>
  pull(n)

prop_sea_aff <- sea[1]/(sea[1] + sea[2])

wildfire <- affected |>
  count(CLIM10_g_W55) |>
  pull(n)

prop_wildfire_aff <- wildfire[1]/(wildfire[1] + wildfire[2])
```

```{r}
drought <- unaffected |>
  count(CLIM10_a_W55) |>
  pull(n)

prop_drought_unaff <- drought[1]/(drought[1] + drought[2])

heat <- unaffected |>
  count(CLIM10_b_W55) |>
  pull(n)

prop_heat_unaff <- heat[1]/(heat[1] + heat[2])

sweather <- unaffected |>
  count(CLIM10_c_W55) |>
  pull(n)

prop_sweather_unaff <- sweather[1]/(sweather[1] + sweather[2])

sea <- unaffected |>
  count(CLIM10_d_W55) |>
  pull(n)

prop_sea_unaff <- sea[1]/(sea[1] + sea[2])

wildfire <- unaffected |>
  count(CLIM10_g_W55) |>
  pull(n)

prop_wildfire_unaff <- wildfire[1]/(wildfire[1] + wildfire[2])


```

```{r affected_barplot}

event_prop_aff <- data.frame(event = c("Drought", "Excessive Heat", "Flood/Storm", "Sea Levels Rising", "Wildfires"),
                         prop = c(prop_drought_aff, prop_heat_aff, prop_sweather_aff, prop_sea_aff, prop_wildfire_aff))

event_prop_aff_bar <- ggplot(event_prop_aff, aes(x = factor(event),
                       y = prop)) +
  geom_bar(stat = "identity") +
  labs(x = "Weather Event",
       y = "Proportion",
       title = "Proportion of People Affected by Severe Weather Events",
       subtitle = "Who Claim They're Affected by Global Warming")

event_prop_aff_bar
```

```{r unaffected_barplot}

event_prop_unaff <- data.frame(event = c("Drought", "Excessive Heat", "Flood/Storm", "Sea Levels Rising", "Wildfires"),
                         prop = c(prop_drought_unaff, prop_heat_unaff, prop_sweather_unaff, prop_sea_unaff, prop_wildfire_unaff))

event_prop_unaff_bar <- ggplot(event_prop_unaff, aes(x = factor(event),
                       y = prop)) +
  geom_bar(stat = "identity") +
  labs(x = "Weather Event",
       y = "Proportion",
       title = "Proportion of People Affected by Severe Weather Events", 
       subtitle = "Who Claim They're Not Affected by Global Warming")

event_prop_unaff_bar
```

DIFFERENCES IN PERSONAL BEHAVIOR
```{r}
#Affected
behavior_aff <- affected |> 
  count(behavior_freq) |>
  filter(behavior_freq != 99)


behavior_aff |>
  ggplot(aes(x = factor(behavior_freq), y = n)) +
  geom_bar(stat = "identity") +
  labs(x = "How often do you make an effort to live in ways that help protect the
 environment?",
   y = "Count")

affected_proportions <- affected |>
  count(behavior_freq) |>
  filter(behavior_freq != "NA") |>
  mutate(aff_prop = n/sum(n)) |>
  select(behavior_freq, aff_prop)

knitr::kable(behavior_aff, col.names = c("Frequency of Environmentally-Beneficial Behavior", "Count of People Affected by Severe Weather"))
```
```{r}
#Unaffected
behavior_unaff <- unaffected |> 
  count(behavior_freq) |>
  filter(behavior_freq != 99)

behavior_unaff
behavior_unaff |>
  ggplot(aes(x = factor(behavior_freq), y = n)) +
  geom_bar(stat = "identity") +
  labs(x = "How often do you make an effort to live in ways that help protect the
 environment?",
   y = "Count")

unaffected_proportions <- unaffected |>
  count(behavior_freq) |>
  filter(behavior_freq != "NA") |>
  mutate(unaff_prop = n/sum(n)) |>
  select(behavior_freq, unaff_prop)

knitr::kable(behavior_unaff, col.names = c("Frequency of Environmentally-Beneficial Behavior", "Count of People Not Affected by Severe Weather"))
```

```{r}
differences_behavior <- data.frame(
  affect_level = c(unaffected_proportions$behavior_freq),
  unaffected = c(unaffected_proportions$unaff_prop),
  affected = c(affected_proportions$aff_prop))

differences_behavior
```

```{r}
differences_behavior |>
  chisq_test(response = affect_level, p = unaffected)
```

